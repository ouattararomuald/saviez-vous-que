buildscript {
  repositories {
    mavenCentral() // or jcenter()
  }

  dependencies {
    classpath 'com.getkeepsafe.dexcount:dexcount-gradle-plugin:0.8.2'
  }
}

apply plugin: 'com.android.application'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-android-extensions'
apply plugin: 'kotlin-kapt'

android {
  compileSdkVersion buildConfig.compileSdk

  defaultConfig {
    applicationId "com.ouattararomuald.saviezvousque"
    minSdkVersion buildConfig.minSdk
    targetSdkVersion buildConfig.targetSdk
    versionCode 1
    versionName '1.0'

    testInstrumentationRunner 'android.support.test.runner.AndroidJUnitRunner'

    vectorDrawables.useSupportLibrary true

    resConfigs 'fr'
  }

  compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_8
    targetCompatibility JavaVersion.VERSION_1_8
  }

  lintOptions {
    textReport true
    textOutput 'stdout'

    // InvalidPackage: Needed cause of SimpleXml
    disable 'AllowBackup', 'InvalidPackage', 'GoogleAppIndexingWarning' // We don't care
  }

  buildTypes {
    def DATABASE_NAME_KEY = 'DATABASE_NAME'
    def FEED_BASE_URL = '"http://saviezvousque.net/wp-json/wp/v2/"'
    def FEED_BASE_URL_KEY = 'FEED_BASE_URL'

    debug {
      buildConfigField 'String', DATABASE_NAME_KEY, '"HaveFunDebug"'
      buildConfigField 'String', FEED_BASE_URL_KEY, FEED_BASE_URL
    }

    release {
      minifyEnabled false
      proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'

      buildConfigField 'String', DATABASE_NAME_KEY, '"HaveFun"'
      buildConfigField 'String', FEED_BASE_URL_KEY, FEED_BASE_URL
    }
  }
}

dependencies {
  implementation fileTree(include: ['*.jar'], dir: 'libs')
  implementation deps.kotlin.stdlib.jdk8
  implementation project(':common')
  implementation project(':db')
  implementation project(':downloaders')

  implementation deps.dagger.runtime
  kapt deps.dagger.compiler

  implementation deps.android.support.appcompatV7
  implementation deps.android.support.vectorDrawables
  implementation deps.android.support.constraintLayout

  implementation deps.fresco

  implementation deps.android.arch.room.rxjava
  implementation deps.android.arch.room.runtime
  kapt deps.android.arch.room.compiler

  implementation deps.retrofit.rxjavaCallAdapter
  implementation deps.retrofit.gsonConverter

  implementation deps.threetenabp

  testImplementation deps.junit

  androidTestImplementation deps.android.test.espresso.runner
  androidTestImplementation deps.android.test.espresso.core
  androidTestImplementation deps.truth
}

apply plugin: 'com.getkeepsafe.dexcount'
